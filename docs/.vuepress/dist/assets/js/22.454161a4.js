(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{222:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"浏览器dom事件与事件监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器dom事件与事件监听"}},[t._v("#")]),t._v(" 浏览器DOM事件与事件监听")]),t._v(" "),s("p",[t._v("事件驱动是"),s("code",[t._v("JavaScript")]),t._v("作为一种脚本语言的特质之一，而事件则是"),s("code",[t._v("JavaScript")]),t._v("和"),s("code",[t._v("HTML")]),t._v("交互的基础。用户想要与任何的浏览器页面进行交互，都要通过绑定相应的事件。")]),t._v(" "),s("p",[t._v("DOM事件分为"),s("code",[t._v("DOM0")]),t._v("、"),s("code",[t._v("DOM2")]),t._v("和"),s("code",[t._v("DOM3")]),t._v("三种（没错，没有"),s("code",[t._v("DOM1")]),t._v("）")]),t._v(" "),s("h2",{attrs:{id:"dom0"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom0"}},[t._v("#")]),t._v(" DOM0")]),t._v(" "),s("p",[t._v("DOM0就是直接通过"),s("code",[t._v("onclick/onchange")]),t._v("等事件属性写在HTML中的事件\n比如：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("btn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onclick")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("alert('DOM0')"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("或者：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'btn'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nbutton"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOM0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("值得注意的是，清理DOM0事件的时候，只需要给该事件赋值为"),s("code",[t._v("null")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onclick "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n")])])]),s("p",[t._v("而且同一个HTML元素只能绑定一个同种事件类型的函数，否则后面的函数会覆盖之前的事件处理函数")]),t._v(" "),s("h2",{attrs:{id:"dom2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom2"}},[t._v("#")]),t._v(" DOM2")]),t._v(" "),s("p",[t._v("DOM2是通过"),s("code",[t._v("addEventListener")]),t._v("绑定的事件，它增加了许多DOM1不支持的新模块。因为浏览器的兼容性问题，在IE下DOM2事件通过"),s("code",[t._v("attchEvent")]),t._v("绑定")]),t._v(" "),s("p",[t._v("DOM2事件中同一个元素的同种事件可以绑定多个事件处理函数，按照绑定顺序依次执行，而清除DOM2事件则需要使用"),s("code",[t._v("removeEventListener/detachEvent")]),t._v("传入函数清除指定函数（所以要移除事件请确保注册事件监听时传入的函数为"),s("strong",[t._v("外部函数")]),t._v("，而不是"),s("strong",[t._v("匿名函数")]),t._v("）")]),t._v(" "),s("p",[t._v("比如：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fnA")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fnB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 绑定事件")]),t._v("\nbutton"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fnA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbutton"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fnB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 移除事件")]),t._v("\nbutton"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fnA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("DOM2级事件有三个参数：")]),t._v(" "),s("ul",[s("li",[t._v("第一个参数是事件名，如"),s("code",[t._v("click, change")])]),t._v(" "),s("li",[t._v("第二个参数是事件处理函数")]),t._v(" "),s("li",[t._v("第三个参数代表事件执行/移除的阶段，"),s("code",[t._v("true")]),t._v("表示在捕获阶段，"),s("code",[t._v("false")]),t._v("表示在冒泡阶段，"),s("code",[t._v("addEventListener")]),t._v("中该参数默认为"),s("code",[t._v("false")]),t._v("，值得注意的是："),s("strong",[t._v("如果你在冒泡阶段和捕获阶段同时绑定了事件，那么移除事件的时候需要选择阶段单独移除")])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("此处要先介绍一下什么是事件流")])])]),t._v(" "),s("h3",{attrs:{id:"事件流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件流"}},[t._v("#")]),t._v(" 事件流")]),t._v(" "),s("p",[t._v("事件流描述的就是从页面中接收事件的顺序。而IE和Netscape提出了完全相反的事件流概念。IE事件流是事件冒泡，而Netscape的事件流就是事件捕获。")]),t._v(" "),s("h3",{attrs:{id:"事件冒泡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件冒泡"}},[t._v("#")]),t._v(" 事件冒泡")]),t._v(" "),s("p",[t._v("IE的事件流叫做事件冒泡。即事件开始时由最具体的元素（文档中嵌套层次最深的那个节点）接收，然后逐级向上传播到较为不具体的节点（文档）。所有现代浏览器都支持事件冒泡，并且会将事件一直冒泡到"),s("code",[t._v("window")]),t._v("对象。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"/img/dom-event/bubbling.png"}})]),t._v(" "),s("h3",{attrs:{id:"事件捕获"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件捕获"}},[t._v("#")]),t._v(" 事件捕获")]),t._v(" "),s("p",[t._v("事件捕获的思想是不太具体的节点应该更早的接收到事件，而在最具体的节点应该最后接收到事件。事件捕获的用以在于事件到达预定目标之前捕获它。IE9+、Safari、Chrome、Opera和Firefox支持，且从"),s("code",[t._v("window")]),t._v("开始捕获（尽管DOM2级事件规范要求从"),s("code",[t._v("document")]),t._v("）。由于老版本浏览器不支持，所以很少有人使用事件捕获。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"/img/dom-event/capturing.png"}})]),t._v(" "),s("h3",{attrs:{id:"dom2事件流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom2事件流"}},[t._v("#")]),t._v(" DOM2事件流")]),t._v(" "),s("p",[t._v("DOM2级事件规定事件流包括三个阶段，事件捕获阶段、处于目标阶段和事件冒泡阶段。首先发生的事件捕获，为截获事件提供了机会；然后是实际的目标接收了事件；最后一个阶段是冒泡阶段，可以在这个阶段对事件做出响应。我们可以通过设置"),s("code",[t._v("addEventListener")]),t._v("的第三个参数来决定是在捕获阶段还是冒泡阶段执行事件。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"/img/dom-event/event-stream.png"}})]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("我们一般注册事件监听都是在事件冒泡阶段，因为它可以帮我们实现事件委托。")])])]),t._v(" "),s("p",[t._v("值得注意的是，事件 handler 的第一个参数事件对象 e 的 e.currentTarget属性指向绑定事件的DOM元素，而 e.target则是指向触发事件的DOM元素，两者在事件委托的模式下可能并不相等。")]),t._v(" "),s("h2",{attrs:{id:"dom3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom3"}},[t._v("#")]),t._v(" DOM3")]),t._v(" "),s("p",[t._v("DOM3进一步扩展了DOM，在DOM3中引入了以下模块：")]),t._v(" "),s("ul",[s("li",[t._v("DOM加载和保存模块（DOM Load and Save）：引入了以统一方式加载和保存文档的方法")]),t._v(" "),s("li",[t._v("DOM验证模块（DOM Validation）：定义了验证文档的方法")]),t._v(" "),s("li",[t._v("DOM核心的扩展（DOM Style）：支持XML 1.0规范，涉及XML Infoset、XPath和XML Base")]),t._v(" "),s("li",[s("strong",[t._v("自定义事件")])])]),t._v(" "),s("h3",{attrs:{id:"dom中的自定义事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom中的自定义事件"}},[t._v("#")]),t._v(" DOM中的自定义事件")]),t._v(" "),s("p",[t._v("DOM3级还定义了自定义事件，自定义事件不是由DOM原生触发的，它的目的是让开发人员创建自己的事件。要创建的自定义事件可以由"),s("code",[t._v('createEvent("CustomEvent")')]),t._v("， 返回的对象有一个"),s("code",[t._v("initCustomEvent")]),t._v("方法接收如下四个参数：")]),t._v(" "),s("ul",[s("li",[t._v("type（字符串）：触发的事件类型，自定义。例如 "),s("code",[t._v("keyDown")]),t._v("，"),s("code",[t._v("selectedChange")])]),t._v(" "),s("li",[t._v("bubble（布尔值）：标示事件是否应该冒泡")]),t._v(" "),s("li",[t._v("cancelable（布尔值）：标示事件是否可以取消")]),t._v(" "),s("li",[t._v("detail：任意值，保存在event对象的detail属性中")])]),t._v(" "),s("p",[t._v("示例如下：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myEvent"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("　　alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div myEvent!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("implementation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasFeature")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomEvents"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n　　"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomEvent"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n　　e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initCustomEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myEvent"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这样button就会在执行这段代码后执行myEvent事件处理函数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);